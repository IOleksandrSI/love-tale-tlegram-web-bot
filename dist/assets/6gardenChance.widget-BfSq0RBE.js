import{r as l,i as A,u as S,Z as z,C as E,j as n,B as j,T as g,a2 as b,a as C}from"./index-BtzxSjkc.js";import{H as F}from"./heading-SoSsjYZm.js";import{V as W}from"./v-stack-CGfUFIum.js";import{A as R,a as T,b as v,c as D,d as H}from"./alert-D0nwkVok.js";import"./create-slot-recipe-context-BKeR3ukz.js";function p(d,h=[]){const i=l.useRef(()=>{throw new Error("Cannot call an event handler while rendering.")});return l.useInsertionEffect(()=>{i.current=d}),l.useCallback((...a)=>{var s;return(s=i.current)==null?void 0:s.call(i,...a)},h)}function I(d={}){const{onClose:h,onOpen:i,open:a}=d,s=p(i),c=p(h),[o,w]=l.useState(d.defaultOpen||!1),f=a!==void 0?a:o,u=a!==void 0,x=l.useCallback(()=>{u||w(!1),c==null||c()},[u,c]),m=l.useCallback(()=>{u||w(!0),s==null||s()},[u,s]),y=l.useCallback(()=>{f?x():m()},[f,m,x]);return{open:f,onOpen:m,onClose:x,onToggle:y}}const G=()=>{const d=A(),{id:h}=S(e=>e.user),[i,a]=l.useState([{id:"f1",name:"Трепетна Довіра",type:"flower",color:"#f6675e",health:3},{id:"f2",name:"Ніжна Надія",type:"flower",color:"#f3dc47",health:3},{id:"f3",name:"Солодкі Спогади",type:"flower",color:"#4949f8",health:3},{id:"w1",name:"Тіні Минулого",type:"weed",color:"#003f44",strength:2},{id:"w2",name:"Потаємні Сумніви",type:"weed",color:"#540909",strength:2}]),[s,c]=l.useState(5),[o,w]=l.useState(!1),{onOpen:f}=I();l.useEffect(()=>{s<=0&&!o&&(w(!0),f(),(async()=>h&&await d(z({chatId:h,chapter:E.GARDEN_CHANCE_6})))())},[s,o,f]);const u=e=>{o||(a(r=>r.map(t=>t.id===e&&t.type==="flower"&&t.health!==void 0?{...t,health:t.health+1}:t)),c(r=>r-1))},x=e=>{o||(a(r=>r.map(t=>t.id===e&&t.type==="flower"&&t.health!==void 0?{...t,health:t.health+2}:t)),c(r=>r-1))},m=e=>{o||(a(r=>r.map(t=>t.id===e&&t.type==="weed"&&t.strength!==void 0?{...t,strength:0}:t)),c(r=>r-1))},y=()=>{let e=0,r=0;return i.forEach(t=>{t.type==="flower"&&t.health!==void 0&&(e+=t.health),t.type==="weed"&&t.strength!==void 0&&(r+=t.strength)}),e-r},k=()=>{const e=y();return e>=10?`
Вітаємо! Ти з любов’ю доглянув(ла) за “Трепетною Довірою”, “Ніжною Надією”
та “Солодкими Спогадами”. Їхній цвіт тепер яскравий і рясний, 
а “Тіні Минулого” й “Потаємні Сумніви” майже зникли.
Сад розквів чарами, а серця сповнені наснагою.
Тепер Кохання готове до найголовнішого кроку...
      `:e>=5?`
Ти старанно плекав(ла) свій сад, і він уже набуває барв. 
Хоч і залишилися деякі тіні чи сумніви, але квітучі пагони надають
віру в майбутнє. Можливо, ще кілька кроків –
і ваші серця повністю готові до нового розділу.
      `:`
Сад поки що не зазнав повного розквіту: декому з квітів забракло турботи, 
а бур’яни залишились на своїх місцях. 
Можливо, ця історія потребує більше часу чи спільних зусиль,
проте попереду ще є шанс вдихнути в неї життя.
      `};return n.jsxs(j,{maxW:"600px",mx:"auto",p:4,children:[n.jsx(F,{size:"lg",textAlign:"center",mb:4,children:"Сад Другого Шансу"}),!o&&n.jsxs(g,{mb:4,color:"white",fontSize:"sm",children:["Перед тобою сад, де символічно зібрані моменти вашого кохання. У тебе є ",n.jsx("strong",{children:s})," дій, аби зміцнити прекрасні квітки та позбутися колючих спогадів. Якщо сад розквітне, це означатиме, що ви обоє готові до нового етапу – і, можливо, до найважливішого запитання, яке от-от пролунає..."]}),n.jsx(W,{align:"stretch",p:3,children:i.map(e=>n.jsx(j,{p:3,borderWidth:"1px",borderRadius:"md",borderColor:"gray.200",bg:"white",children:n.jsxs(b,{justify:"space-between",children:[n.jsxs(j,{children:[n.jsxs(g,{fontWeight:"bold",color:e.color||"black",children:[e.type==="flower"?"Квітка":"Бур’ян",": ",e.name]}),e.type==="flower"?n.jsxs(g,{fontSize:"xs",color:"gray.600",style:{textAlign:"start"},children:["Сила квітки (health): ",e.health]}):n.jsxs(g,{fontSize:"xs",color:"gray.600",style:{textAlign:"start"},children:["Сила бур’яну (strength): ",e.strength]})]}),!o&&n.jsxs(b,{children:[e.type==="flower"&&e.health!==void 0&&n.jsxs(n.Fragment,{children:[n.jsx(C,{size:"xs",style:{backgroundColor:e.color||"black",color:"white"},onClick:()=>u(e.id),children:"Полити"}),n.jsx(C,{size:"xs",style:{backgroundColor:e.color||"black",color:"white"},onClick:()=>x(e.id),children:"Добрива"})]}),e.type==="weed"&&e.strength!==void 0&&e.strength>0&&n.jsx(C,{size:"xs",style:{backgroundColor:e.color||"black",color:"white"},onClick:()=>m(e.id),children:"Вирвати"})]})]})},e.id))}),o&&n.jsxs(R,{status:"info",variant:"subtle",mt:6,children:[n.jsx(T,{}),n.jsxs(v,{flex:"1",children:[n.jsx(D,{children:"Результат:"}),n.jsx(H,{whiteSpace:"pre-line",children:k()})]})]}),!o&&n.jsx(j,{mt:4,textAlign:"center",children:n.jsxs(g,{fontSize:"sm",mb:2,children:["Залишилося дій: ",n.jsx("strong",{children:s})]})})]})};export{G as default};
