import{a as f,f as y,g as v,c as A,u as O,r as g}from"./use-environment-context-CbcAjUHh.js";import{V as U,Q as M,a5 as E,r as l,j as N,a6 as S,a7 as T}from"./index-BtzxSjkc.js";const R=n=>f()(n,["immediate","lazyMount","onExitComplete","present","unmountOnExit"]);function h(n,e,t){const a=n.matches("mounted","unmountSuspended");return{skip:!n.context.initial&&a,present:a,setNode(o){o&&e({type:"NODE.SET",node:o})},unmount(){e({type:"UNMOUNT"})}}}function C(n){return U({initial:n.present?"mounted":"unmounted",context:{node:null,styles:null,unmountAnimationName:null,prevAnimationName:null,present:!1,initial:!1,...n},exit:["clearInitial","cleanupNode"],watch:{present:["setInitial","syncPresence"]},on:{"NODE.SET":{actions:["setNode","setStyles"]}},states:{mounted:{on:{UNMOUNT:{target:"unmounted",actions:["invokeOnExitComplete"]},"UNMOUNT.SUSPEND":"unmountSuspended"}},unmountSuspended:{activities:["trackAnimationEvents"],after:{ANIMATION_DURATION:{target:"unmounted",actions:["invokeOnExitComplete"]}},on:{MOUNT:{target:"mounted",actions:["setPrevAnimationName"]},UNMOUNT:{target:"unmounted",actions:["invokeOnExitComplete"]}}},unmounted:{entry:["clearPrevAnimationName"],on:{MOUNT:{target:"mounted",actions:["setPrevAnimationName"]}}}}},{delays:{ANIMATION_DURATION(e){var t,a;return P((t=e.styles)==null?void 0:t.animationDuration)+P((a=e.styles)==null?void 0:a.animationDelay)+I}},actions:{setInitial(e){e.initial=!0},clearInitial(e){e.initial=!1},cleanupNode(e){e.node=null,e.styles=null},invokeOnExitComplete(e){var t;(t=e.onExitComplete)==null||t.call(e)},setNode(e,t){e.node=E(t.node)},setStyles(e,t){const a=t.node.ownerDocument.defaultView||window;e.styles=E(a.getComputedStyle(t.node))},syncPresence(e,t,{send:a}){var r;if(e.present){a({type:"MOUNT",src:"presence.changed"});return}if(!e.present&&((r=e.node)==null?void 0:r.ownerDocument.visibilityState)==="hidden"){a({type:"UNMOUNT",src:"visibilitychange"});return}const o=p(e.styles);(e.immediate?queueMicrotask:requestAnimationFrame)(()=>{var i,m;e.unmountAnimationName=o,o==="none"||o===e.prevAnimationName||((i=e.styles)==null?void 0:i.display)==="none"||((m=e.styles)==null?void 0:m.animationDuration)==="0s"?a({type:"UNMOUNT",src:"presence.changed"}):a({type:"UNMOUNT.SUSPEND"})})},setPrevAnimationName(e){(e.immediate?queueMicrotask:requestAnimationFrame)(()=>{e.prevAnimationName=p(e.styles)})},clearPrevAnimationName(e){e.prevAnimationName=null}},activities:{trackAnimationEvents(e,t,{send:a}){const o=e.node;if(!o)return;const u=i=>{var s,c;(((c=(s=i.composedPath)==null?void 0:s.call(i))==null?void 0:c[0])??i.target)===o&&(e.prevAnimationName=p(e.styles))},r=i=>{var c,d;const m=p(e.styles);(((d=(c=i.composedPath)==null?void 0:c.call(i))==null?void 0:d[0])??i.target)===o&&m===e.unmountAnimationName&&a({type:"UNMOUNT",src:"animationend"})};return o.addEventListener("animationstart",u),o.addEventListener("animationcancel",r),o.addEventListener("animationend",r),()=>{o.removeEventListener("animationstart",u),o.removeEventListener("animationcancel",r),o.removeEventListener("animationend",r)}}}})}function p(n){return(n==null?void 0:n.animationName)||"none"}function P(n){return parseFloat(n||"0")*1e3}var I=16.667;M()(["onExitComplete","present","immediate"]);const _=n=>{const{lazyMount:e,unmountOnExit:t,present:a,...o}=n,u=l.useRef(!1),r={...o,present:a,onExitComplete:y(n.onExitComplete)},[i,m]=v(C(r),{context:r}),s=h(i,m);s.present&&(u.current=!0);const c=!s.present&&!u.current&&e||t&&!s.present&&u.current,d=()=>({"data-state":a?"open":"closed",hidden:!s.present});return{ref:s.setNode,getPresenceProps:d,present:s.present,unmounted:c}},[L,F]=A({name:"PresenceContext",hookName:"usePresenceContext",providerName:"<PresenceProvider />"}),j=n=>{var m;const{children:e,disabled:t}=n,[a,o]=l.useState((m=n.container)==null?void 0:m.current),u=l.useSyncExternalStore(x,()=>!1,()=>!0),{getRootNode:r}=O();if(l.useEffect(()=>{o(()=>{var s;return(s=n.container)==null?void 0:s.current})},[n.container]),u||t)return N.jsx(N.Fragment,{children:e});const i=a??D(r);return N.jsx(N.Fragment,{children:l.Children.map(e,s=>g.createPortal(s,i))})},D=n=>{const e=n==null?void 0:n(),t=e.getRootNode();return S(t)?t:T(e).body},x=()=>()=>{};export{L as P,F as a,j as b,R as s,_ as u};
